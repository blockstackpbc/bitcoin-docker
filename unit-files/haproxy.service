# haproxy.service
[Unit]
Description=HAproxy service for btc
After=docker.service
Requires=docker.service
After=create_docker_network.service
Requires=create_docker_network.service

[Service]
TimeoutStartSec=0
Restart=on-failure

ExecStartPre=-/usr/bin/docker stop bitcoin_haproxy
ExecStartPre=-/usr/bin/docker rm bitcoin_haproxy
ExecStartPre=/usr/bin/docker pull haproxy:alpine
ExecStart=/usr/bin/docker run -d \
  --net=bitcoind \
  -m 128m \
  -p 8332:8332 \
  -p 8333:8333 \
  -p 80:80 \
  -p 443:443 \
  -p 443:443 \
  -p 1024:1024 \
  -p 3000:3000 \
  --expose=80 \
  --expose=443 \
  --expose=1024 \
  --expose=3000 \
  --expose=8332 \
  --expose=8333 \
  -v /bitcoind/configs/haproxy/haproxy.cfg:/usr/local/etc/haproxy/haproxy.cfg \
  --name bitcoin_haproxy \
  haproxy:alpine \
/usr/local/sbin/haproxy -f /usr/local/etc/haproxy/haproxy.cfg -L ${HOSTNAME}

[Install]
WantedBy=multi-user.target
